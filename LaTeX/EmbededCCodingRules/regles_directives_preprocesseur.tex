\section{Directives préprocesseur}

\begin{center}
\begin{tabular}{|c p{12.3cm}|}
\hline
\rowcolor{red!10}\textbf{Règle 4.1} & Les {\fontfamily{AnonymousPro}\selectfont\color{orange}{\#{}undef}} sont interdits. \\ \hline
 & Une directive {\fontfamily{AnonymousPro}\selectfont\color{orange}{\# undef}} peut rendre obscur le fait qu'une macro soit définie ou non. \\
 & Il est tout aussi efficace et plus clair de mettre en commentaire une directive \#{}define afin de ne plus définir une macro utilisateur à la compilation. De plus lors d'une recherche dans un fichier ou sur un ensemble de fichiers, il est plus évident visuellement de comprendre si une macro est définie ou non lorsque l'on rencontre {\fontfamily{AnonymousPro}\selectfont\color{green}{//\# define}} plutôt que {\fontfamily{AnonymousPro}\selectfont\color{orange}{\# undef}}. \\ \hline
\hline
\end{tabular}
\end{center}

\smallskip
\begin{large}
\textbf{\textsc{Exception :}}
\end{large}
Si la désactivation de mots clef du compilateur est nécessaire, on pourra utiliser la directive {\fontfamily{AnonymousPro}\selectfont\color{orange}{\# undef}}. Il faudra alors documenter et justifier son usage.

\medskip

\begin{center}
\begin{tabular}{|c p{12.3cm}|}
\hline
\rowcolor{red!10}\textbf{Règle 4.2} & Une macro ne doit jamais pouvoir être confondue avec une constante. \\ \hline
 & Ce type de confusion à la lecture du code est aisément évitable et simplifiera toujours la compréhension par un autre programmeur amené à reprendre la partie du code en question. \\ \hline
\hline
\end{tabular}
\end{center}
 
\smallskip
\begin{large}
\textbf{\textsc{Exemple :}}
\end{large}
\lstinputlisting{code_c_samples/macro_definition.c}

\pagebreak

\begin{center}
\begin{tabular}{|c p{12.3cm}|}
\hline
\rowcolor{red!10}\textbf{Règle 4.3} & On préfèrera toujours écrire une fonction plutôt qu'une macro si les deux sont interchangeables. \\ \hline
 & Une fonction est déboguable plus facilement qu'une macro. \\ \hline
\hline
\end{tabular}
\end{center}
 
\smallskip
\begin{large}
\textbf{\textsc{Exemple :}}
\end{large}
\lstinputlisting{code_c_samples/macro_against_function.c}

\medskip

\begin{center}
\begin{tabular}{|c p{12.3cm}|}
\hline
\rowcolor{red!10}\textbf{Règle 4.4} & Toute directive {\fontfamily{AnonymousPro}\selectfont\color{orange}{\# include}\color{mymauve}{"unFichier.h"}}/{\fontfamily{AnonymousPro}\selectfont\color{mymauve}{<unFichier.h>}} ne doit être précédées que par des directives préprocesseur ou des commentaires. On placera systématiquement les directives {\fontfamily{AnonymousPro}\selectfont\color{orange}{\# include}} en tête de fichier. \\ \hline
 & Placer les directives {\fontfamily{AnonymousPro}\selectfont\color{orange}{\# include}} en début de fichier permet de s'assurer rapidement que les références nécessaires au fonctionnement du module sont présentes. Si elles se situent de façon dispersée au travers du fichier, cela peut entrainer un comportement indéfini si l'inclusion de certains modules font appel à des références incluses seulement par d'autres plus bas dans le fichier \\ \hline
\hline
\end{tabular}
\end{center}
 
\smallskip
\begin{large}
\textbf{\textsc{Exemple :}}
\end{large}
Ce qui suit est une mauvaise pratique.

\lstinputlisting{code_c_samples/include_location.c}

\medskip

\begin{center}
\begin{tabular}{|c p{12.3cm}|}
\hline
\rowcolor{red!10}\textbf{Règle 4.5} & Les séquences de drapeaux de compilation {\fontfamily{AnonymousPro}\selectfont\color{orange}{\#{}if} 0 [...] \color{orange}{\#{}else} [...] \color{orange}{\#{}endif}} et {\fontfamily{AnonymousPro}\selectfont\color{orange}{\#{}if} 0 [...] \color{orange}{\#{}endif}} sont interdites. \\ \hline
 & L'utilisation de tels drapeaux de compilation rends immédiatement mort le code encadré par {\fontfamily{AnonymousPro}\selectfont\color{orange}{\#{}if} 0 [...] \color{orange}{\#{}else}} ou par {\fontfamily{AnonymousPro}\selectfont\color{orange}{\#{}if} 0 [...] \color{orange}{\#{}endif}}. Selon l'\textit{IDE} utilisé, cela n'apparaitra pas de façon claire et évidente, pouvant induire un programmeur en erreur. Cela peut tout aussi bien se faire en passant le code concerné en commentaire. \\ \hline
\hline
\end{tabular}
\end{center}
 
\pagebreak
